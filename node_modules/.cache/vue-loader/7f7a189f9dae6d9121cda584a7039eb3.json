{"remainingRequest":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/dashboard/components/Info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/dashboard/components/Info.vue","mtime":1564235050840},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapGetters } from \"vuex\";\nimport { getTimeDate } from \"@/utils/index.js\";\n\nimport Qs from \"qs\";\nexport default {\n  filters: {\n    statusFilter(status) {\n      const statusMap = {\n        正常: \"success\",\n        pending: \"danger\"\n      };\n      return statusMap[status];\n    }\n  },\n  data() {\n    return {\n      fileurl1: \"\",\n      fileurl2: \"\",\n      fileurl3: \"\",\n\n      form: {\n        userId: \"\",\n        name: \"\",\n        address: \"\",\n        trueName: \"\",\n        idCard: \"\",\n        contact1: \"\",\n        contact2: \"\",\n        contact3: \"\",\n        wechat: \"\",\n        qq: \"\",\n        files: \"\"\n      },\n      fileList: [],\n      formRules: {\n        userId: [\n          { required: true, trigger: \"blur\", message: \"请输入手机号码\" }\n        ],\n        name: [{ required: true, trigger: \"blur\", message: \"请输入商户名称\" }],\n        trueName: [\n          { required: true, trigger: \"blur\", message: \"请输入真实姓名\" }\n        ],\n        address: [\n          { required: true, trigger: \"blur\", message: \"请输入商户地址\" }\n        ],\n        idCard: [\n          { required: true, trigger: \"blur\", message: \"请输入身份证号\" }\n        ],\n        wechat: [{ required: true, trigger: \"blur\", message: \"请输入微信号\" }],\n        qq: [{ required: true, trigger: \"blur\", message: \"请输入QQ号码\" }]\n      }\n    };\n  },\n  computed: {\n    ...mapGetters([\"userinfo\"]),\n    getLastlogintime() {\n      return getTimeDate(this.$store.state.userinfo.dbUpdateSysTime);\n    },\n    getBusinessStatus() {\n      let userinfo = this.$store.state.userinfo;\n      return userinfo.statusName;\n    },\n    getFoomdisabled() {\n      let userinfo = this.$store.state.userinfo;\n      return userinfo.businessStatusId == 4 || userinfo.businessStatusId == 6;\n    }\n  },\n  mounted() {\n    this.getBusinessinfo();\n  },\n  methods: {\n    getFileName(url) {\n      if (!url || url.length == 0) return \"\";\n      let arr = url.split(\"/\");\n      return arr[arr.length - 1];\n    },\n    onSubmit() {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          let filestr = \"\";\n          //整理文件参数\n          if (this.fileList.length < 3) {\n            return this.$message.error(\"请上传身份证件\");\n          } else {\n            this.fileList.forEach(item => {\n              filestr = filestr + item.fileId + \",\";\n            });\n          }\n\n          let param = {\n            id: JSON.parse(this.userinfo).id,\n            name: this.form.name,\n            trueName: this.form.trueName,\n            idCard: this.form.idCard,\n            address: this.form.address,\n            contact1: this.form.contact1,\n            contact2: this.form.contact2,\n            contact3: this.form.contact3,\n            wechat: this.form.wechat,\n            qq: this.form.qq,\n            files: filestr.substring(0, filestr.length - 1)\n          };\n          this.axios\n            .put(this.urls.editinfo + \"?\" + Qs.stringify(param))\n            .then(response => {\n              if (response.code == 0) return this.$message.error(response.msg);\n              this.$store.commit(\"userinfo\", response.data);\n              this.$message({\n                message: \"操作成功\",\n                type: \"success\"\n              });\n              this.getBusinessinfo();\n            });\n        }\n      });\n    },\n    onEdit() {\n      this.$refs.form.validate(valid => {\n        if (valid) {\n          let param = {\n            id: JSON.parse(this.userinfo).id,\n            name: this.form.name,\n            trueName: this.form.trueName,\n            idCard: this.form.idCard,\n            address: this.form.address,\n            contact1: this.form.contact1,\n            contact2: this.form.contact2,\n            contact3: this.form.contact3,\n            wechat: this.form.wechat,\n            qq: this.form.qq,\n            files: this.form.files\n          };\n          this.axios\n            .put(this.urls.editinfo + \"?\" + Qs.stringify(param))\n            .then(response => {\n              if (response.code == 0) return this.$message.error(response.msg);\n              this.$message({\n                message: \"操作成功\",\n                type: \"success\"\n              });\n              this.getBusinessinfo();\n            });\n        }\n      });\n    },\n\n    //获取商户基本信息\n    getBusinessinfo() {\n      this.axios.get(this.urls.businessinfo).then(response => {\n        if (response.code == 0) return this.$message.error(response.msg);\n\n        let userinfo = response.data;\n\n        this.$store.commit(\"userinfo\", userinfo);\n\n        this.form = userinfo;\n\n        this.getFilesUrl();\n\n        switch (userinfo.businessStatusId) {\n          case \"1\":\n          case \"2\":\n          case \"3\":\n            this.$refs.p.style.color = \"orange\";\n            break;\n          case \"4\":\n            this.$refs.p.style.color = \"green\";\n            break;\n          case \"5\":\n            this.$refs.p.style.color = \"red\";\n            break;\n          default:\n            break;\n        }\n      });\n    },\n\n    //获取商户资料信息\n    getFilesUrl() {\n      if (this.form.files.length == 0) return;\n      let arr = this.form.files.split(\",\");\n\n      this.axios.get(this.urls.getFileurl + \"?id=\" + arr[0]).then(response => {\n        if (response.code == 0) return this.$message.error(response.msg);\n        this.fileurl1 =\n          this.urls.imgbaseurl +\n          response.data.substring(2, response.data.length);\n      });\n\n      this.axios.get(this.urls.getFileurl + \"?id=\" + arr[1]).then(response => {\n        if (response.code == 0) return this.$message.error(response.msg);\n        this.fileurl2 =\n          this.urls.imgbaseurl +\n          response.data.substring(2, response.data.length);\n      });\n\n      this.axios.get(this.urls.getFileurl + \"?id=\" + arr[2]).then(response => {\n        if (response.code == 0) return this.$message.error(response.msg);\n        this.fileurl3 =\n          this.urls.imgbaseurl +\n          response.data.substring(2, response.data.length);\n      });\n    },\n    handleRemove(file, fileList) {\n      console.log(file, fileList);\n      this.fileList.pop(file);\n    },\n    handlePreview(file) {\n      console.log(file);\n    },\n    beforeRemove(file, fileList) {\n      return this.$confirm(`确定移除 ${file.name}？`);\n    },\n    handleChange(file, fileList) {\n      this.fileList = fileList;\n    },\n\n    //导入附件的excel表格成功回调\n    upElSuccess(response, file, fileList) {\n      if (response) {\n        file.fileId = response.data[0];\n      }\n    }\n  }\n};\n",null]}