{"remainingRequest":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/mission/taskinfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/mission/taskinfo.vue","mtime":1567220898045},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport CountTo from \"vue-count-to\";\nimport { getFormList, getDeliveroptions, getFormRules } from \"./form.js\";\nimport Qs from \"qs\";\n\nexport default {\n  name: \"taskInfo\",\n  components: { CountTo },\n  props: {\n    isShowDialog: Boolean,\n    taskData: { type: Object }\n  },\n  watch: {\n    taskData: function(newValue, oldValue) {\n      this.taskInfo = newValue;\n\n      this.mainForm = this.taskInfo;\n      this.formList = JSON.parse(this.mainForm.content);\n\n      let form = {};\n      this.formList.forEach(item => {\n        form[item.field] = item.value;\n      });\n      this.otherForm = form;\n\n      this.getCommentImgurl();\n    }\n  },\n  data() {\n    return {\n      dialogImageUrl: \"\",\n\n      additionSalary: 0, //重标签的金额\n      fileList: [],\n      taskInfo: null,\n      dialogVisible: false,\n      commentImages: [], //好评图片\n\n      shopList: [],\n      formList: [],\n      shoptypelist: [],\n      loading: false,\n      deliveroptions: [],\n      formRules: {},\n      otherForm: {},\n      mainForm: {\n        id: \"\", //任务id\n        shopId: \"\", //店铺\n        missionType: \"\", //任务类型 淘宝京东\n        clientType: \"PC\", //终端类型  手机端  pc\n        goodsUrl: \"\", //商品链接\n        goodsTitle: \"\", //商品名称\n        commentUrl: \"\", //带图好评\n        keyWords: \"\", //关键词\n        goodsImg: \"\", //商品主图   url\n        payMent: \"平台担保\", // 付款方式  平台担保  立返  远程代付\n        unitPrice: \"\", //商品单价\n        buyNum: \"1\", //每单购买数量\n        salary: \"\", //每单佣金\n        goodsType: \"实物\", //商品类型  虚拟 实物\n        deliverTime: \"发货3天后好评\", //收货时间   1天后 2天后\n        evaluateRequire: \"默认好评\", //评价要求 文字好评  五星好评 带图评价\n        missionQuantity: \"1\", //任务数量\n        assess: \"\", //指定好评内容\n        message: \"\" //商家备注留言\n      }\n    };\n  },\n  computed: {\n    getbalance() {\n      let userinfo = this.$store.state.userinfo;\n      return userinfo.balance;\n    },\n    getbasePrice() {\n      let userinfo = this.$store.state.userinfo;\n      return userinfo.basePrice;\n    },\n    getGoodsprice() {\n      if (this.mainForm.payMent == \"商家远程代付\") return 0;\n      let total =\n        this.mainForm.unitPrice *\n        this.mainForm.buyNum *\n        this.mainForm.missionQuantity;\n      return total;\n    },\n    getSalary() {\n      let total = this.mainForm.salary * this.mainForm.missionQuantity;\n      return total.toFixed(2);\n    },\n    getAlltakeoff() {\n      let t = this.getSalary * 1 + this.getGoodsprice * 1;\n      return t.toFixed(2);\n    }\n  },\n  created() {\n    //获取店铺类型\n    this.axios.get(this.urls.shoptypelist).then(response => {\n      this.shoptypelist = response.data;\n    });\n\n    //获取店铺列表\n    this.getShopList();\n\n    //获取动态form\n    this.formList = getFormList();\n\n    //获取收货时间数据\n    this.deliveroptions = getDeliveroptions();\n\n    //获取校验表单规则数据\n    this.formRules = getFormRules();\n  },\n  mounted() {\n    if (this.taskInfo) {\n      this.mainForm = this.taskInfo;\n      this.formList = JSON.parse(this.mainForm.content);\n\n      let form = {};\n      this.formList.forEach(item => {\n        form[item.field] = item.value;\n      });\n      this.otherForm = form;\n    } else {\n      //新增任务\n      let form = {};\n      this.formList.forEach(item => {\n        form[item.field] = item.value;\n      });\n      this.otherForm = form;\n    }\n  },\n  methods: {\n    //根据好评图片的数据获取好评图片的地址\n    getCommentImgurl() {\n      if (this.mainForm.commentUrl) {\n        let arr = this.mainForm.commentUrl.split(\",\");\n\n        let _that = this;\n        _that.commentImages = [];\n        arr.forEach(item => {\n          if (item) {\n            this.axios\n              .get(this.urls.getFileurl + \"?id=\" + item)\n              .then(response => {\n                if (response.code == 0)\n                  return this.$message.error(response.msg);\n                _that.commentImages.push(\n                  this.urls.imgbaseurl +\n                    response.data.substring(2, response.data.length)\n                );\n              });\n          }\n        });\n      }\n    },\n    //获取店铺列表\n    getShopList() {\n      let param = {\n        businessId: this.$store.state.userinfo\n          ? this.$store.state.userinfo.id\n          : \"\",\n        name: \"\",\n        _uiName_: \"eleme\",\n        _pagination: \"{'pageNumber':1,'pageSize':10}\"\n      };\n      this.axios\n        .get(this.urls.shoplist + \"?\" + Qs.stringify(param))\n        .then(response => {\n          this.shopList = response.data.list;\n        });\n    },\n\n    //dialog关闭按钮\n    handleClose() {\n      // this.isNewDialog = false;\n      this.$emit(\"editDialog\", false);\n    }\n  }\n};\n",null]}