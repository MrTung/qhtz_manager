{"remainingRequest":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/thread-loader/dist/cjs.js!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/babel-loader/lib/index.js!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/mission/taskinfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/src/views/mission/taskinfo.vue","mtime":1564109831543},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/dongxuwei/Desktop/系统相关/代码/advance-platform/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getFormList, getDeliveroptions, getFormRules } from \"./form.js\";\nimport Qs from \"qs\";\nexport default {\n  name: \"taskInfo\",\n  components: {},\n  props: {\n    isShowDialog: Boolean,\n    taskData: {\n      type: Object\n    }\n  },\n  watch: {\n    taskData: function taskData(newValue, oldValue) {\n      this.taskInfo = newValue;\n      this.mainForm = this.taskInfo;\n      this.formList = JSON.parse(this.mainForm.content);\n      var form = {};\n      this.formList.forEach(function (item) {\n        form[item.field] = item.value;\n      });\n      this.otherForm = form;\n    }\n  },\n  data: function data() {\n    return {\n      taskInfo: null,\n      shopList: [],\n      formList: [],\n      shoptypelist: [],\n      loading: false,\n      deliveroptions: [],\n      formRules: {},\n      otherForm: {},\n      mainForm: {\n        id: \"\",\n        //任务id\n        shopId: \"\",\n        //店铺\n        missionType: \"\",\n        //任务类型 淘宝京东\n        clientType: \"PC\",\n        //终端类型  手机端  pc\n        goodsUrl: \"\",\n        //商品链接\n        goodsTitle: \"\",\n        //商品名称\n        goodsImg: \"\",\n        //商品主图   url\n        payMent: \"平台担保\",\n        // 付款方式  平台担保  立返  远程代付\n        unitPrice: \"\",\n        //商品单价\n        buyNum: \"1\",\n        //每单购买数量\n        salary: \"\",\n        //每单佣金\n        goodsType: \"实物\",\n        //商品类型  虚拟 实物\n        deliverTime: \"发货3天后好评\",\n        //收货时间   1天后 2天后\n        evaluateRequire: \"默认好评\",\n        //评价要求 文字好评  五星好评 带图评价\n        missionQuantity: \"1\",\n        //任务数量\n        message: \"\" //商家备注留言\n\n      }\n    };\n  },\n  computed: {\n    getbalance: function getbalance() {\n      var userinfo = this.$store.state.userinfo;\n      return userinfo.balance;\n    },\n    getGoodsprice: function getGoodsprice() {\n      if (this.mainForm.payMent == \"商家远程代付\") return 0;\n      var total = this.mainForm.unitPrice * this.mainForm.buyNum * this.mainForm.missionQuantity;\n      return total;\n    },\n    getSalary: function getSalary() {\n      var total = this.mainForm.salary * this.mainForm.missionQuantity;\n      return total.toFixed(2);\n    },\n    getAlltakeoff: function getAlltakeoff() {\n      var t = this.getSalary * 1 + this.getGoodsprice * 1;\n      return t.toFixed(2);\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    //获取店铺类型\n    this.axios.get(this.urls.shoptypelist).then(function (response) {\n      _this.shoptypelist = response.data;\n    }); //获取店铺列表\n\n    this.getShopList(); //获取动态form\n\n    this.formList = getFormList(); //获取收货时间数据\n\n    this.deliveroptions = getDeliveroptions(); //获取校验表单规则数据\n\n    this.formRules = getFormRules(); //获取商家信息数据\n\n    this.getBusinessinfo();\n  },\n  mounted: function mounted() {\n    if (this.taskInfo) {\n      this.mainForm = this.taskInfo;\n      this.formList = JSON.parse(this.mainForm.content);\n      var form = {};\n      this.formList.forEach(function (item) {\n        form[item.field] = item.value;\n      });\n      this.otherForm = form;\n    } else {\n      //新增任务\n      var _form = {};\n      this.formList.forEach(function (item) {\n        _form[item.field] = item.value;\n      });\n      this.otherForm = _form;\n    }\n  },\n  methods: {\n    //获取店铺列表\n    getShopList: function getShopList() {\n      var param = {\n        businessId: this.$store.state.userinfo.id,\n        name: \"\",\n        _uiName_: \"eleme\",\n        _pagination: \"{'pageNumber':1,'pageSize':10}\"\n      };\n      this.axios.get(this.urls.shoplist + \"?\" + Qs.stringify(param)).then(function (response) {// this.shopList = response.data.list;\n      });\n    },\n    onSubmit: function onSubmit() {\n      var _this2 = this;\n\n      if (this.getbalance < this.getGoodsprice + this.getSalary) return this.$message.error(\"您的账户余额不足以发布本次任务,请充值后再试\");\n      this.$refs.mainForm.validate(function (valid) {\n        if (valid) {\n          {\n            var h = _this2.$createElement;\n\n            _this2.$msgbox({\n              title: \"提示\",\n              message: h(\"p\", null, [h(\"span\", null, \"本次任务将从您的账户扣除 \"), h(\"span\", {\n                style: \"color: red;font-size:19px;font-weight:bold\"\n              }, \"￥\" + _this2.getAlltakeoff), h(\"span\", null, \",是否发布?\")]),\n              showCancelButton: true,\n              confirmButtonText: \"确定\",\n              cancelButtonText: \"取消\",\n              beforeClose: function beforeClose(action, instance, done) {\n                if (action === \"confirm\") {\n                  _this2.addMisson(\"4\");\n\n                  done();\n                } else {\n                  done();\n                }\n              }\n            }).then(function (action) {});\n          }\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    onSave: function onSave() {\n      var _this3 = this;\n\n      this.$refs.mainForm.validate(function (valid) {\n        if (valid) {\n          _this3.addMisson(\"1\");\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n    //新增任务\n    addMisson: function addMisson(type) {\n      var _this4 = this;\n\n      this.formList.forEach(function (item) {\n        item.value = _this4.otherForm[item.field];\n      });\n      var param = {\n        id: this.mainForm.id | \"\",\n        taskStatusId: type,\n        businessId: this.$store.state.userinfo.id,\n        shopId: this.mainForm.shopId,\n        missionType: this.mainForm.missionType,\n        clientType: this.mainForm.clientType,\n        goodsUrl: this.mainForm.goodsUrl,\n        goodsImg: this.mainForm.goodsImg,\n        goodsTitle: this.mainForm.goodsTitle,\n        payMent: this.mainForm.payMent,\n        unitPrice: this.mainForm.unitPrice,\n        buyNum: this.mainForm.buyNum,\n        goodsType: this.mainForm.goodsType,\n        salary: this.mainForm.salary,\n        deliverTime: this.mainForm.deliverTime,\n        evaluateRequire: this.mainForm.evaluateRequire,\n        missionQuantity: this.mainForm.missionQuantity,\n        message: this.mainForm.message,\n        content: JSON.stringify(this.formList)\n      };\n      this.loading = true;\n      this.axios.post(this.urls.addMission + \"?\" + Qs.stringify(param)).then(function (response) {\n        _this4.loading = false;\n\n        _this4.getBusinessinfo();\n\n        _this4.$message({\n          message: type == \"1\" ? \"保存成功!\" : \"发布成功!\",\n          type: \"success\"\n        });\n\n        if (type == \"2\") {\n          _this4.$refs.mainForm.resetFields();\n\n          _this4.$refs.otherForm.resetFields();\n        }\n      });\n    },\n    //获取用户余额等信息\n    getBusinessinfo: function getBusinessinfo() {\n      var _this5 = this;\n\n      this.axios.get(this.urls.businessinfo).then(function (response) {\n        if (response.code == 0) return _this5.$message.error(response.msg);\n        var userinfo = response.data;\n\n        _this5.$store.commit(\"userinfo\", userinfo);\n      });\n    },\n    //dialog关闭按钮\n    handleClose: function handleClose() {\n      // this.isNewDialog = false;\n      this.$emit(\"editDialog\", false);\n    }\n  }\n};",null]}